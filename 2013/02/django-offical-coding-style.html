<!DOCTYPE html>
<html lang="zh-hans" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml" class="han-init">
<head>
    <title>[django]官方编码规范 - Mozillazg's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://mozillazg.com/favicon.ico" rel="icon">

<link rel="canonical" href="http://mozillazg.com/2013/02/django-offical-coding-style.html">

        <meta name="author" content="mozillazg" />
        <meta name="keywords" content="django,python" />
        <meta name="description" content="请以最新的官方英文版为准：https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/ 编码风格 当编写 Django 代码时，请遵循下列编码规范。 Python 风格 除非另有规定，否则请遵循 PEP 8 风格指南。 你可以使用类似 pep8 的工具检查你的代码， 但是，请记住 PEP 8 只是个指南，并非强制约束，因此应当以你所处项目/团队的风格为主。 一个比较大的例外就是，PEP 8 规定代码行长最长不能超过 79 个字符。问题是现在是 21 世纪了，我们有高分辨率的显示器可以显示超过 79 个字符的代码行。如果这这个约定让代码看起来很丑或难以阅读的话，那么就没必要限制行长不超过 79 个字符 ..." />

        <meta property="og:site_name" content="Mozillazg's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="[django]官方编码规范"/>
        <meta property="og:url" content="http://mozillazg.com/2013/02/django-offical-coding-style.html"/>
        <meta property="og:description" content="请以最新的官方英文版为准：https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/ 编码风格 当编写 Django 代码时，请遵循下列编码规范。 Python 风格 除非另有规定，否则请遵循 PEP 8 风格指南。 你可以使用类似 pep8 的工具检查你的代码， 但是，请记住 PEP 8 只是个指南，并非强制约束，因此应当以你所处项目/团队的风格为主。 一个比较大的例外就是，PEP 8 规定代码行长最长不能超过 79 个字符。问题是现在是 21 世纪了，我们有高分辨率的显示器可以显示超过 79 个字符的代码行。如果这这个约定让代码看起来很丑或难以阅读的话，那么就没必要限制行长不超过 79 个字符 ..."/>
        <meta property="article:published_time" content="2013-02-01" />
            <meta property="article:section" content="django" />
            <meta property="article:tag" content="django" />
            <meta property="article:tag" content="python" />
            <meta property="article:author" content="mozillazg" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://mozillazg.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://mozillazg.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://mozillazg.com/theme/css/pygments/solarizedlight.css" rel="stylesheet">
    <link rel="stylesheet" href="http://mozillazg.com/theme/css/style.css" type="text/css"/>
            <link href="http://mozillazg.com/static/yue.css" rel="stylesheet">

        <link href="http://mozillazg.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Mozillazg's Blog ATOM Feed"/>

        <link href="http://mozillazg.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Mozillazg's Blog RSS Feed"/>


        <link href="http://mozillazg.com/feeds/django.atom.xml" type="application/atom+xml" rel="alternate"
              title="Mozillazg's Blog django ATOM Feed"/>

    <style>
        .container {
            max-width: 970px;
        }
    </style>
<style>
article .page-header {
    border-bottom: none;
    margin-bottom: 55px;
}
article .page-header h1 {
    font-size: 3em;
    font-weight: 500;
}
article .published {
    font-size: 1.8rem;
    /*font-weight: 400;*/
    color: #9EABB3;
    margin-top: 1.1rem;
}
article .entry-content {
    color: #2F2F2F;
}
article .entry-content .article-info {
    border-bottom: 1px solid #dededc;
    margin-bottom: 2em;
}
</style>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://mozillazg.com/" class="navbar-brand">
Mozillazg's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="/archives.html">Archives</a></li>
                         <li><a href="http://mozillazg.com/2014/10/pages/about-me.html">
                             About me
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://mozillazg.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content" class="yue">
        <article>
            <header class="page-header text-center">
                <h1>
                    <a href="http://mozillazg.com/2013/02/django-offical-coding-style.html"
                       rel="bookmark"
                       title="Permalink to [django]官方编码规范">
                        [django]官方编码规范
                    </a>
                </h1>
                <p class="published">
                    <time datetime="2013-02-01T00:00:00+00:00">
                    周五 01 二月 2013
                    </time>
                </p>
            </header>
            <div class="entry-content">
                <div class="well-sm article-info">
<footer class="post-info">
        <a href="http://mozillazg.com/category/django.html">django</a>


<span class="label label-default hide">Tags</span>
	<a href="http://mozillazg.com/tag/django.html">django</a>
        /
	<a href="http://mozillazg.com/tag/python.html">python</a>
    
</footer><!-- /.post-info -->                </div>
                <div>
                <p>请以最新的官方英文版为准：<a href="https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/">https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/</a></p>
<h2 id="_1">编码风格</h2>
<p>当编写 Django 代码时，请遵循下列编码规范。</p>
<h3 id="python">Python 风格</h3>
<ul>
<li>
<p>除非另有规定，否则请遵循 <a href="http://www.python.org/dev/peps/pep-0008">PEP 8</a> 风格指南。    <br />
  你可以使用类似 <a href="http://pypi.python.org/pypi/pep8">pep8</a> 的工具检查你的代码，
  但是，请记住 <a href="http://www.python.org/dev/peps/pep-0008">PEP 8</a> 只是个指南，并非强制约束，因此应当以你所处项目/团队的风格为主。    <br />
  一个比较大的例外就是，<a href="http://www.python.org/dev/peps/pep-0008">PEP 8</a> 规定代码行长最长不能超过 79 个字符。问题是现在是 21 世纪了，我们有高分辨率的显示器可以显示超过 79 个字符的代码行。如果这这个约定让代码看起来很丑或难以阅读的话，那么就没必要限制行长不超过 79 个字符。</p>
</li>
<li>
<p>使用4个空格进行缩进。</p>
</li>
<li>
<p>使用下划线而不是小驼峰法（camelCase）命名变量、函数及方法名（比如，poll.get_unique_voters()，不要使用 poll.getUniqueVoters）。</p>
</li>
<li>
<p>使用首字母大写（InitialCaps）的方式命名类名（或能够返回类的工厂函数）。</p>
</li>
<li>
<p>文档字符串中，使用动词（action words）。比如：</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates something and returns the result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>


<p>反例：</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate something and return the result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>


</li>
</ul>
<h3 id="_2">模板风格</h3>
<ul>
<li>
<p>在模板中，大括号及标签内容之间使用一个（只需一个）空格。    <br />
  应该这样：</p>
<div class="codehilite"><pre><span class="cp">{{</span> <span class="nv">foo</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>


<p>别这样：</p>
<div class="codehilite"><pre><span class="cp">{{</span><span class="nv">foo</span><span class="cp">}}</span><span class="x"></span>
</pre></div>


</li>
</ul>
<h3 id="_3">视图风格</h3>
<ul>
<li>
<p>在视图中，视图函数的第一个参数应该被命名为 request。     <br />
  应该这样：</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">foo</span><span class="p">):</span>
    <span class="c"># ...</span>
</pre></div>


<p>别这样：</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">foo</span><span class="p">):</span>
    <span class="c"># ...</span>
</pre></div>


</li>
</ul>
<h3 id="_4">模型风格</h3>
<ul>
<li>
<p>字段名应该全部小写，使用下划线代替小驼峰法。
  应该这样：</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>


<p>别这样：</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">FirstName</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">Last_Name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p><code>class Meta</code> 应该在字段被定义<em>后</em>才出现，使用一个空行分隔。
  应该这样：</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;people&#39;</span>
</pre></div>


<p>别这样：</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;people&#39;</span>
</pre></div>


<p>也别这样：</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">&#39;people&#39;</span>

    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>model 内的类和方法的定义顺序应该遵循如下顺序（不是所有项都是必需的）：       </p>
<ol>
<li>所有的数据库字段          </li>
<li>自定义<a href="https://docs.djangoproject.com/en/dev/topics/db/managers/">管理器属性（manager attributes）</a>         </li>
<li><code>class Meta</code>          </li>
<li><code>def __unicode__()</code>       </li>
<li><code>def __str__()</code>       </li>
<li><code>def save()</code>          </li>
<li><code>def get_absolute_url()</code>          </li>
<li>其他自定义方法        </li>
</ol>
</li>
<li>
<p>如果一个 model 字段定义了 <code>choices</code>，那么定义的多元元组的名称应该全部大写。例如：      </p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">DIRECTION_UP</span> <span class="o">=</span> <span class="s">&#39;U&#39;</span>
    <span class="n">DIRECTION_DOWN</span> <span class="o">=</span> <span class="s">&#39;D&#39;</span>
    <span class="n">DIRECTION_CHOICES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">DIRECTION_UP</span><span class="p">,</span> <span class="s">&#39;Up&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">DIRECTION_DOWN</span><span class="p">,</span> <span class="s">&#39;Down&#39;</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>


</li>
</ul>
<h3 id="djangoconfsettings">django.conf.settings 的使用</h3>
<p>模块不常用的设置项被储存在 <code>django.conf.settings</code> 中</p>
<p>Modules should not in general use settings stored in <code>django.conf.settings</code> at the top level (i.e. evaluated when the module is imported). The explanation for this is as follows:</p>
<p>Manual configuration of settings (i.e. not relying on the <code>DJANGO_SETTINGS_MODULE</code> environment variable) is allowed and possible as follows:</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="n">settings</span><span class="o">.</span><span class="n">configure</span><span class="p">({},</span> <span class="n">SOME_SETTING</span><span class="o">=</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>


<p>However, if any setting is accessed before the settings.configure line, this will not work. (Internally, <code>settings</code> is a <code>LazyObject</code> which configures itself automatically when the settings are accessed if it has not already been configured).</p>
<p>So, if there is a module containing some code as follows:</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">get_callable</span>

<span class="n">default_foo_view</span> <span class="o">=</span> <span class="n">get_callable</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">FOO_VIEW</span><span class="p">)</span>
</pre></div>


<p>...then importing this module will cause the settings object to be configured. That means that the ability for third parties to import the module at the top level is incompatible with the ability to configure the settings object manually, or makes it very difficult in some circumstances.</p>
<p>Instead of the above code, a level of laziness or indirection must be used, such as <code>django.utils.functional.LazyObject</code>, <code>django.utils.functional.lazy()</code> or <code>lambda</code>.</p>
<h3 id="miscellaneous">Miscellaneous</h3>
<ul>
<li>Mark all strings for internationalization; see the i18n documentation for details.</li>
<li>Remove import statements that are no longer used when you change code. The most common tools for this task are pyflakes and pylint.</li>
<li>Systematically remove all trailing whitespaces from your code as those add unnecessary bytes, add visual clutter to the patches and can also occasionally cause unnecessary merge conflicts. Some IDE’s can be configured to automatically remove them and most VCS tools can be set to highlight them in diff outputs. Note, however, that patches which only remove whitespace (or only make changes for nominal PEP 8 conformance) are likely to be rejected, since they only introduce noise rather than code improvement. Tidy up when you’re next changing code in the area.</li>
<li>Please don’t put your name in the code you contribute. Our policy is to keep contributors’ names in the AUTHORS file distributed with Django – not scattered throughout the codebase itself. Feel free to include a change to the AUTHORS file in your patch if you make more than a single trivial change.</li>
</ul>
                </div>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://mozillazg.com/2013/04/django-custom-model-display-name-on-admin-pages.html">[django]自定义 model 在后台显示的名称</a></li>
        <li><a href="http://mozillazg.com/2013/04/django-admin-add-user-form-include-email-field.html">[django]让后台新增用户的表单包含 email 字段</a></li>
        <li><a href="http://mozillazg.com/2013/06/django-fix-reset-password-use-webmaster@localhost-send-mail.html">[django]解决发送密码重置邮件的发件人是 "webmaster@localhost" 的问题</a></li>
        <li><a href="http://mozillazg.com/2013/01/django-pagination-by-use-paginator.html">[django]使用 Paginator 实现分页功能</a></li>
        <li><a href="http://mozillazg.com/2013/02/django-typeerror-decod-argument-1-must-be-string-not-none.html">[django] 创建后台超级用户时出现 TypeError: decode() argument 1 must be string, not None 错误</a></li>
    </ul>
</section>
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'my-github-blog'; // required: replace example with your forum shortname

                    var disqus_identifier = 'django-offical-coding-style';
                var disqus_url = 'http://mozillazg.com/2013/02/django-offical-coding-style.html';

            var disqus_config = function () {
                this.language = "zh-hans";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 mozillazg
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
    &quot;<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Mozillazg's Blog</span>&quot; by <a xmlns:cc="http://creativecommons.org/ns#" href="http://mozillazg.com" property="cc:attributionName" rel="cc:attributionURL">mozillazg</a> is
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://mozillazg.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://mozillazg.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://mozillazg.com/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'my-github-blog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>